# Ismaque.org API 集成文档

## 概览

本应用已成功集成 ismaque.org 统一 AI API，支持 OpenAI、Google Gemini 和 Anthropic Claude 系列模型。用户无需配置 API 密钥，只需选择所需的模型即可使用。

## 主要变更

### 1. API 密钥管理
- **内置 API 密钥**：应用已集成有效的 ismaque.org API 密钥
- **零配置使用**：用户无需输入或管理 API 密钥
- **统一接入点**：所有 AI 模型通过 `https://ismaque.org/v1` 端点访问

### 2. 核心文件修改

#### ProcessingHelper.ts
- 内置固定 API 密钥：`sk-xYuBFrEaKatCu3dqlRsoUx5RiUOuPsk1oDPi0WJEEiK1wloP`
- 移除了对配置中 API 密钥的依赖
- 简化了客户端初始化逻辑
- 保持所有原有功能：题目提取、解决方案生成、调试分析

#### ConfigHelper.ts
- 移除 `apiKey` 配置字段
- 移除 API 密钥验证和测试方法
- 简化配置结构，专注于模型选择
- 保持模型映射和验证功能

#### SettingsDialog.tsx
- 移除 API 密钥输入界面
- 简化为只包含：AI 服务商选择、模型配置、编程语言、窗口透明度
- 使用项目现有的 UI 组件
- 增加内置密钥说明提示

## 支持的模型

### OpenAI 系列
- `gpt-4o` (推荐) - 最新最强的多模态模型
- `gpt-4o-mini` (快速) - 成本效益高的快速版本
- `gpt-4` (经典) - 稳定的高质量选择
- `gpt-3.5-turbo` (高效) - 经济实惠的基础选择

### Google Gemini 系列
- `gemini-2.0-flash` (推荐) - 最新的快速模型
- `gemini-1.5-pro` (专业) - 强大的专业级模型
- `gemini-pro` (经典) - 经典稳定版本

### Anthropic Claude 系列
- `claude-3-7-sonnet-20250219` (推荐) - 最新的平衡模型
- `claude-3-5-sonnet-20241022` (稳定) - 稳定的专业版本
- `claude-3-opus-20240229` (最强) - 顶级智能模型

## 用户体验改进

### 简化的设置界面
1. **AI 服务商选择**：三个主要提供商的直观选择
2. **模型配置**：针对不同任务（题目识别、解题生成、调试分析）的独立模型选择
3. **编程语言偏好**：支持 14 种主流编程语言
4. **窗口透明度**：可调节的界面透明度设置

### 零配置体验
- 应用启动即可使用
- 无需注册或配置第三方服务
- 自动管理 API 访问和错误处理

## 技术优势

### 统一 API 接口
- 所有模型使用相同的 OpenAI 兼容格式
- 简化了代码维护和错误处理
- 便于未来扩展和模型升级

### 智能模型映射
- 根据用户选择的提供商自动映射正确的模型名称
- 支持不同任务使用不同模型的灵活配置
- 内置默认模型确保最佳体验

### 中文优化
- 所有 AI 提示词已完全本地化为中文
- 错误消息和用户反馈均为中文
- 针对中文编程面试场景优化

## 安全与可靠性

### API 密钥安全
- API 密钥内置于应用中，用户无法直接访问
- 避免了用户误操作或密钥泄露的风险
- 统一管理确保服务稳定性

### 错误处理
```typescript
// 示例：改进的错误处理
if (error?.response?.status === 401) {
  return {
    success: false,
    error: "API访问错误，请联系开发者。"
  };
} else if (error?.response?.status === 429) {
  return {
    success: false,
    error: "API调用频率限制，请稍后重试。"
  };
}
```

### 自动重试机制
- 网络超时：60秒
- 最大重试：2次
- 智能退避策略

## 使用说明

### 首次使用
1. 启动应用
2. 点击设置按钮
3. 选择偏好的 AI 服务商
4. 选择适合的模型配置
5. 设置编程语言偏好
6. 保存设置即可开始使用

### 模型推荐

#### 为不同任务选择模型：

**题目识别**：推荐使用各提供商的默认模型
- OpenAI: `gpt-4o`
- Gemini: `gemini-2.0-flash`
- Claude: `claude-3-7-sonnet-20250219`

**解题生成**：根据复杂度选择
- 简单题目：使用 mini/flash 版本以提高速度
- 复杂题目：使用完整版本以确保质量

**调试分析**：推荐使用最强模型
- OpenAI: `gpt-4o`
- Gemini: `gemini-1.5-pro`
- Claude: `claude-3-opus-20240229`

## 兼容性说明

### 向后兼容
- 现有配置文件会自动迁移
- 保留所有原有功能和工作流程
- 现有截图和数据不受影响

### 系统要求
- Windows 10/11
- Node.js 环境（Electron 应用）
- 稳定的网络连接

## 故障排除

### 常见问题

**Q: 如果 API 服务不可用怎么办？**
A: 应用会显示相应错误信息，建议稍后重试。如持续出现问题，请联系开发者。

**Q: 可以使用自己的 API 密钥吗？**
A: 当前版本不支持自定义 API 密钥，以确保服务稳定性和用户体验一致性。

**Q: 如何切换不同的 AI 模型？**
A: 在设置界面中选择不同的 AI 服务商，应用会自动切换到对应的模型集合。

## 更新历史

### v2.0 - 内置 API 密钥版本
- 集成 ismaque.org API 密钥
- 移除用户 API 密钥配置需求
- 简化设置界面
- 优化用户体验流程

### v1.0 - 初始 ismaque.org 集成
- 添加 ismaque.org API 支持
- 统一多提供商模型访问
- 中文化所有提示词
- 完整的错误处理机制

---

*此文档反映了应用的最新状态。如有任何问题或建议，请联系开发者。* 